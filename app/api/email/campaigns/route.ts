export const runtime = 'nodejs';
import { NextRequest,NextResponse } from 'next/server';import { db } from '@/db/client';import { emailCampaigns } from '@/db/schema';export async function GET(){const rows=await db.select().from(emailCampaigns);return NextResponse.json(rows);}export async function POST(req:NextRequest){const b=await req.json();const r=await db.insert(emailCampaigns).values({subject:b.subject,html:b.html}).returning();return NextResponse.json(r[0]);}export async function PUT(req:NextRequest){const b=await req.json();await db.update(emailCampaigns).set({subject:b.subject,html:b.html,status:b.status??'draft'}).where(emailCampaigns.id.eq(b.id));return NextResponse.json({ok:true});}export async function DELETE(req:NextRequest){const {id}=await req.json();await db.delete(emailCampaigns).where(emailCampaigns.id.eq(id));return NextResponse.json({ok:true});}
