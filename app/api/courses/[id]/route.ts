export const runtime = 'nodejs';
import { NextResponse } from 'next/server';import { db } from '@/db/client';import { courses,modules,lessons } from '@/db/schema';import { eq } from 'drizzle-orm';export async function GET(_:Request,{params}:{params:{id:string}}){const course=(await db.select().from(courses).where(eq(courses.id,params.id)).limit(1))[0];if(!course)return NextResponse.json({message:'Not found'},{status:404});const mods=await db.select().from(modules).where(eq(modules.courseId,params.id));const allLessons=await Promise.all(mods.map(async m=>({module:m,lessons:await db.select().from(lessons).where(eq(lessons.moduleId,m.id))})));return NextResponse.json({course,content:allLessons});}
