'use client';import { useEffect,useState } from 'react';import { useParams } from 'next/navigation';export default function AdminCourseDetail(){const {id}=useParams<{id:string}>();const [modules,setModules]=useState<any[]>([]);const [title,setTitle]=useState('');const [position,setPosition]=useState<number>(0);const [lessons,setLessons]=useState<Record<string,any[]>>({});async function load(){const m=await fetch(`/api/admin/modules/${id}`).then(r=>r.json());setModules(m);const all:Record<string,any[]>={};for(const mod of m){all[mod.id]=await fetch(`/api/admin/lessons/${mod.id}`).then(r=>r.json());}setLessons(all);}useEffect(()=>{if(id)load();},[id]);async function createModule(){const r=await fetch(`/api/admin/modules/${id}`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({title,position})});if(r.ok){setTitle('');setPosition(0);load();}}async function createLesson(moduleId:string){const t=prompt('Título da lição')||'';if(!t)return;await fetch(`/api/admin/lessons/${moduleId}`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({title:t})});load();}return(<main className="p-6 space-y-4"><h1 className="title">Gerenciar curso</h1><div className="card space-y-2 max-w-xl"><input className="input" placeholder="Título do módulo" value={title} onChange={e=>setTitle(e.target.value)}/><input className="input" type="number" placeholder="Posição" value={position} onChange={e=>setPosition(parseInt(e.target.value||'0',10))}/><button onClick={createModule} className="btn btn-sm">Adicionar módulo</button></div><div className="space-y-3">{modules.map(m=>(<div key={m.id} className="card"><div className="flex items-center justify-between"><h2 className="subtitle">{m.title}</h2><button onClick={()=>createLesson(m.id)} className="btn btn-outline btn-sm">Adicionar lição</button></div><ul className="mt-2 space-y-2">{(lessons[m.id]||[]).map(l=>(<li key={l.id} className="flex items-center justify-between"><span>{l.title}</span></li>))}</ul></div>))}</div></main>)}
