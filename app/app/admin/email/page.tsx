'use client';import { useEffect,useState } from 'react';export default function AdminEmail(){const [lists,setLists]=useState<any[]>([]);const [tags,setTags]=useState<any[]>([]);const [camps,setCamps]=useState<any[]>([]);const [subject,setSubject]=useState('');const [html,setHtml]=useState('');async function load(){const [l,t,c]=await Promise.all([fetch('/api/email/lists').then(r=>r.json()),fetch('/api/email/tags').then(r=>r.json()),fetch('/api/email/campaigns').then(r=>r.json()),]);setLists(l);setTags(t);setCamps(c);}useEffect(()=>{load();},[]);async function createCamp(){const r=await fetch('/api/email/campaigns',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({subject,html})});if(r.ok){setSubject('');setHtml('');load();}}async function send(id:string){await fetch('/api/email/campaigns/send',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({id})});load();}return(<main className="p-6 space-y-4"><h1 className="title">E-mail</h1><div className="grid-2"><div className="card space-y-2"><h2 className="subtitle">Nova campanha</h2><input className="input" placeholder="Assunto" value={subject} onChange={e=>setSubject(e.target.value)}/><textarea className="input h-40" placeholder="HTML" value={html} onChange={e=>setHtml(e.target.value)}/><button onClick={createCamp} className="btn btn-sm">Criar</button></div><div className="card"><h2 className="subtitle mb-2">Campanhas</h2><ul className="space-y-2">{camps.map(c=>(<li key={c.id} className="flex items-center justify-between border p-2 rounded"><div><div className="font-medium">{c.subject}</div><div className="text-xs">{c.status}</div></div><button onClick={()=>send(c.id)} className="btn btn-outline btn-sm">Enviar</button></li>))}</ul></div></div></main>)}
